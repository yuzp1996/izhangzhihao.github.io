## 如何使用 *django* 邮箱发送邮件

***

####  今天来带大家一起揭秘

查了查资料，感觉是有两种方法来进行邮件的发送，一个是django包装好的，还有一个是纯python的做法，今天我实验总结一下


先来说一下各种邮箱协议，直接上图


其实我认为比较麻烦的问题还是在邮箱的设置上，我就是要用自己的qq邮箱来发送消息的，设置起来如果是第一次还是很有问题的，但是其实也就是几步，首先在QQ **设置** 中 **账号** 里打开几个服务， ![qq截图](https://raw.githubusercontent.com/yuzp1996/yuzp1996.github.io/master/websites/qqmail.png)

只要把这就几个服务打开了，然后注意下面的温馨提示，咱们是第三方登录呦，所以是需要独立于当前qq号码之外的也就是所谓的授权码，现在上代码 **这是直接从项目中拿下来的代码**



	import smtplib
	from email.mime.text import MIMEText
    from django.core.cache import cache
 	def post_email(email, option):


	def post_email(email, option):
    """
    发送email方法，参数说明
    email：邮箱地址
    option: 用户进行的操作,例如：找回密码
    :param req:
    :return:
    """

    mail_from = "yuzp1996@qq.com"
    mail_passwd = "lmeyriwpro***ede" #这个是所谓的授权码 
    mail_host = "smtp.qq.com"  #这个就是host
    six = "".join(random.sample(['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'], 6))
    print six
    content = """<html><p>猪婆，您好，您正在进行"""\
              + option + """操作，切勿将验证码泄露于他人，15分钟内有效。
                   验证码：<B>""" \
              + six + """</B>【来自深夜臭公的问候】</p>
                   </html>"""
    msg = MIMEText(content, _subtype='html', _charset='utf8')
    msg['Subject'] = option
    msg['From'] = mail_from
    msg['To'] = email
    try:
        cache.set(email, " ")
        cache.delete(email)
        cache.set(email, six, timeout=900)
        smtp = smtplib.SMTP_SSL("smtp.qq.com", 465)  # 创建实例 其他的就不一样在 比如126中    smtp = smtplib.SMTP() 用在QQ上就不可以，会提示错误，没有ssl连接 

        smtp.connect(mail_host)  # 连接邮箱服务器
        smtp.login(mail_from, mail_passwd)  # 登录邮箱 使用专属于第三方密码
        smtp.sendmail(mail_from, email, msg.as_string())  # 发送邮件
        smtp.close()
        return 1
    except Exception, err:
        print err
        return 0


这样基本上就可以发送邮件了，当然这个是需要在外网上跑服务才可以发送邮件的，比如我在学校的局域网里跑django的服务发送邮件就是发送不出去，但是在腾讯云服务器上就可以发送邮件。


*小知识：js判定格式：*

    var filter  = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    if(filter.test(emailVal)==false){
        emailPromptLabel.html("邮箱格式不正确"）

*良好的编码风格：*

    def post_email(email, option):
    """
    发送email方法，参数说明
    email：邮箱地址
    option: 用户进行的操作,例如：找回密码
    :param req:
    :return:
    """

关于redis在windows上的安装有个不错的博客 [前往](http://keenwon.com/1275.html)



